<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to process your Giotto object? • Giotto Suite</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../../bootstrap-toc.css">
<script src="../../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../../pkgdown.css" rel="stylesheet">
<script src="../../../pkgdown.js"></script><meta property="og:title" content="How to process your Giotto object?">
<meta property="og:description" content="Giotto">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-BCXT5392QC"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-BCXT5392QC');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../../index.html">Giotto Suite</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0.960</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Start
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../../articles/getting_started.html#installation">Installation</a>
    </li>
    <li>
      <a href="../../../articles/getting_started.html#getting-started">Getting Started</a>
    </li>
    <li>
      <a href="../../../articles/getting_started.html#analyses">Analyses</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Datasets
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../../articles/datasets_overview.html#array-based-datasets-1">Array based</a>
    </li>
    <li>
      <a href="../../../articles/datasets_overview.html#single-cell-1">Single-cell</a>
    </li>
    <li>
      <a href="../../../articles/datasets_overview.html#subcellular-datasets-1">Subcellular</a>
    </li>
    <li>
      <a href="../../../articles/datasets_overview.html#protein-multiplexing-1">Protein multiplexing</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../../articles/contribute.html">Contribute</a>
</li>
<li>
  <a href="../../../articles/giotto_news.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    FAQ
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../../articles/faqs.html">Frequently Asked Questions</a>
    </li>
    <li>
      <a href="../../../articles/github_issues.html">GitHub Issues Guidelines</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Try Giotto
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Docker</li>
    <li class="dropdown-header">Binder</li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RubD/Giotto/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="data_processing_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to process your Giotto object?</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RubD/Giotto/blob/master/vignettes/vignettes/vignettes/data_processing.Rmd"><code>vignettes/vignettes/vignettes/data_processing.Rmd</code></a></small>
      <div class="hidden name"><code>data_processing.Rmd</code></div>

    </div>

    
    
<p>After creating your Giotto object, it needs to be prepared for downstream analysis. This tutorials walks through filtering, normalization, adjusting for batch effects, and adding statistics and metadata to your Giotto object as well as high efficency options for data processing.</p>
<p>This tutorial uses a SeqFISH+ dataset of a murine cortex and subventrical zone. A complete walkthough of that dataset can be found <a href="./SeqFISH_cortex_210923.html"><strong>here</strong></a>.</p>
<div id="creating-our-giotto-object" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-our-giotto-object" class="anchor"></a>Creating our Giotto Object</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rubd.github.io/Giotto/">Giotto</a></span><span class="op">)</span>
<span class="va">my_working_dir</span> <span class="op">=</span> <span class="st">'/path/to/directory/'</span>

<span class="co"># set python path to your preferred python version path</span>
<span class="co"># set python path to NULL if you want to automatically install (only the 1st time) and use the giotto miniconda environment</span>
<span class="va">python_path</span> <span class="op">=</span> <span class="cn">NULL</span> 
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">python_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../../../reference/installGiottoEnvironment.html">installGiottoEnvironment</a></span><span class="op">(</span>force_environment <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu"><a href="../../../reference/getSpatialDataset.html">getSpatialDataset</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">'seqfish_SS_cortex'</span>, directory <span class="op">=</span> <span class="va">my_working_dir</span>, method <span class="op">=</span> <span class="st">'wget'</span><span class="op">)</span>

<span class="co">#  set Giotto instructions</span>
<span class="va">instrs</span> <span class="op">=</span> <span class="fu"><a href="../../../reference/createGiottoInstructions.html">createGiottoInstructions</a></span><span class="op">(</span>save_plot <span class="op">=</span> <span class="cn">TRUE</span>, 
                                  show_plot <span class="op">=</span> <span class="cn">FALSE</span>,
                                  save_dir <span class="op">=</span> <span class="va">my_working_dir</span>, 
                                  python_path <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="co"># create giotto object from provided paths ####</span>
<span class="va">expr_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_working_dir</span>, <span class="st">"cortex_svz_expression.txt"</span><span class="op">)</span>
<span class="va">loc_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_working_dir</span>, <span class="st">"cortex_svz_centroids_coord.txt"</span><span class="op">)</span>
<span class="va">meta_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">my_working_dir</span>, <span class="st">"cortex_svz_centroids_annot.txt"</span><span class="op">)</span>


<span class="co">#This dataset contains multiple field of views which need to be stitched together</span>

<span class="co"># first merge location and additional metadata</span>
<span class="va">SS_locations</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span><span class="va">loc_path</span><span class="op">)</span>
<span class="va">cortex_fields</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span><span class="va">meta_path</span><span class="op">)</span>
<span class="va">SS_loc_annot</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html">merge.data.table</a></span><span class="op">(</span><span class="va">SS_locations</span>, <span class="va">cortex_fields</span>, by <span class="op">=</span> <span class="st">'ID'</span><span class="op">)</span>
<span class="va">SS_loc_annot</span><span class="op">[</span>, <span class="va">ID</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ID</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">'cell_'</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">913</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">setorder</a></span><span class="op">(</span><span class="va">SS_loc_annot</span>, <span class="va">ID</span><span class="op">)</span>

<span class="co"># create file with offset information</span>
<span class="va">my_offset_file</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span>field <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,
                                        x_offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1654.97</span>, <span class="fl">1750.75</span>, <span class="fl">1674.35</span>, <span class="fl">675.5</span>, <span class="fl">2048</span>, <span class="fl">675</span><span class="op">)</span>,
                                        y_offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1438.02</span>, <span class="op">-</span><span class="fl">1438.02</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="co"># create a stitch file</span>
<span class="va">stitch_file</span> <span class="op">=</span> <span class="fu"><a href="../../../reference/stitchFieldCoordinates.html">stitchFieldCoordinates</a></span><span class="op">(</span>location_file <span class="op">=</span> <span class="va">SS_loc_annot</span>,
                                     offset_file <span class="op">=</span> <span class="va">my_offset_file</span>,
                                     cumulate_offset_x <span class="op">=</span> <span class="cn">T</span>,
                                     cumulate_offset_y <span class="op">=</span> <span class="cn">F</span>,
                                     field_col <span class="op">=</span> <span class="st">'FOV'</span>,
                                     reverse_final_x <span class="op">=</span> <span class="cn">F</span>,
                                     reverse_final_y <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">stitch_file</span>    <span class="op">=</span> <span class="va">stitch_file</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">ID</span>, <span class="va">X_final</span>, <span class="va">Y_final</span><span class="op">)</span><span class="op">]</span>
<span class="va">my_offset_file</span> <span class="op">=</span> <span class="va">my_offset_file</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">field</span>, <span class="va">x_offset_final</span>, <span class="va">y_offset_final</span><span class="op">)</span><span class="op">]</span>

<span class="co"># create Giotto object</span>
<span class="va">testobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/create%20Giotto%20object.html">createGiottoObject</a></span><span class="op">(</span>expression <span class="op">=</span> <span class="va">expr_path</span>,
                                 spatial_locs <span class="op">=</span> <span class="va">stitch_file</span>,
                                 offset_file <span class="op">=</span> <span class="va">my_offset_file</span>,
                                 instructions <span class="op">=</span> <span class="va">instrs</span><span class="op">)</span>

<span class="co"># add additional annotation if wanted</span>
<span class="va">testobj</span> <span class="op">=</span> <span class="fu"><a href="../../../reference/addCellMetadata.html">addCellMetadata</a></span><span class="op">(</span><span class="va">testobj</span>,
                             new_metadata <span class="op">=</span> <span class="va">cortex_fields</span>,
                             by_column <span class="op">=</span> <span class="cn">T</span>,
                             column_cell_ID <span class="op">=</span> <span class="st">'ID'</span><span class="op">)</span>

<span class="co"># subset data to the cortex field of views</span>
<span class="va">cell_metadata</span> <span class="op">=</span> <span class="fu"><a href="../../../reference/pDataDT.html">pDataDT</a></span><span class="op">(</span><span class="va">testobj</span><span class="op">)</span>
<span class="va">cortex_cell_ids</span> <span class="op">=</span> <span class="va">cell_metadata</span><span class="op">[</span><span class="va">FOV</span> <span class="op">%in%</span> <span class="fl">0</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">$</span><span class="va">cell_ID</span>
<span class="va">testobj</span> <span class="op">=</span> <span class="fu"><a href="../../../reference/subsetGiotto.html">subsetGiotto</a></span><span class="op">(</span><span class="va">testobj</span>, cell_ids <span class="op">=</span> <span class="va">cortex_cell_ids</span><span class="op">)</span></code></pre></div>
</div>
<div id="filtering-the-giotto-object" class="section level2">
<h2 class="hasAnchor">
<a href="#filtering-the-giotto-object" class="anchor"></a>1. Filtering the Giotto Object</h2>
<p>You can filter a Giotto object to based on expression thresholds. -<strong>feat_det_in_min_cells</strong> sets a threshold of the number of cells that must include a feature, to keep that feature in the dataset -<strong>min_det_feats_per_cell</strong> sets a threshold of the number of features expressed by a cell to keep that cell in the dataset.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">testobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/filterGiotto.html">filterGiotto</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">testobj</span>,
                          expression_threshold <span class="op">=</span> <span class="fl">1</span>,
                          feat_det_in_min_cells <span class="op">=</span> <span class="fl">100</span>,
                          min_det_feats_per_cell <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
<p>If you are not sure how stringent your filters should be, you can check the distribution of feature expression</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../../reference/filterDistributions.html">filterDistributions</a></span><span class="op">(</span><span class="va">testobj</span>, detection <span class="op">=</span> <span class="st">'feats'</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/images/SeqFish_mouse_cortex/0-filterDistributions.png" style="width:50.0%"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="fu"><a href="../../../reference/filterDistributions.html">filterDistributions</a></span><span class="op">(</span><span class="va">testobj</span>, detection <span class="op">=</span> <span class="st">'cells'</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/images/SeqFish_mouse_cortex/1-filterDistributions.png" style="width:50.0%"></p>
<p><strong>filterCombinations</strong> can also be used to test how different filtering parameters will affect the number of cells and features in your dataset.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../../reference/filterCombinations.html">filterCombinations</a></span><span class="op">(</span><span class="va">testobj</span>,
                   expression_thresholds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,
                   feat_det_in_min_cells <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span>,
                   min_det_feats_per_cell <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="../inst/images/SeqFish_mouse_cortex/11-filterCombinations.png" style="width:50.0%"></p>
</div>
<div id="normalization-of-raw-counts-data" class="section level2">
<h2 class="hasAnchor">
<a href="#normalization-of-raw-counts-data" class="anchor"></a>2. Normalization of Raw Counts Data</h2>
<p>There are two methods of normalization supported by Giotto. Method A normalizes the data by total library size and a custom scale factor, then log transforms the data and z-scores the data by genes and or cells.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># normalize to scale expression values of the Giotto object using method A and z-scoring feats over cells</span>
<span class="va">testobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/normalizeGiotto.html">normalizeGiotto</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">testobj</span>, norm_methods <span class="op">=</span> <span class="st">'standard'</span>, scale_feats <span class="op">=</span> <span class="cn">TRUE</span>, scalefactor <span class="op">=</span> <span class="fl">6000</span>, verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p>Method B uses the Lause/Kobak et al. method. Fist, expected values are calculated based on Pearson correlations. Next, z-scores are calculated based on observed and expected values.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># normalize to scale expression values of the Giotto object using method B </span>
<span class="va">testobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/normalizeGiotto.html">normalizeGiotto</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">testobj</span>, norm_methods <span class="op">=</span> <span class="st">'pearson_resid'</span>, scale_feats <span class="op">=</span> <span class="cn">TRUE</span>, scalefactor <span class="op">=</span> <span class="fl">6000</span>, verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
</div>
<div id="add-statistics-and-metadata" class="section level2">
<h2 class="hasAnchor">
<a href="#add-statistics-and-metadata" class="anchor"></a>3. Add Statistics and Metadata</h2>
<p>Addiing statistics will add the following statistics to cell metadata -<strong>nr_feats</strong>: Denotes in how many features are detected per cell</p>
<p>-<strong>perc_feats</strong>: Denotes what percentage of features is detected per cell</p>
<p>-<strong>total_expr</strong>: Shows the total sum of feature expression per cell</p>
<p>as well as the following statistics to feature metadata -<strong>nr_cells</strong>: Denotes in how many cells the feature is detected</p>
<p>-<strong>per_cells</strong>: Denotes in what percentage of cells the feature is detected</p>
<p>-<strong>total_expr</strong>: Shows the total sum of feature expression in all cells</p>
<p>-<strong>mean_expr</strong>: Average feature expression in all cells</p>
<p>-<strong>mean_expr_det</strong>: Average feature expression in cells with detectable levels of the gen</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># add gene &amp; cell statistics to the giotto object</span>
<span class="va">testobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/addStatistics.html">addStatistics</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">testobj</span>, expression_values <span class="op">=</span> <span class="st">'normalized'</span><span class="op">)</span>
<span class="va">testobj</span><span class="op">@</span><span class="va">cell_metadata</span><span class="op">$</span><span class="va">rna</span>
<span class="va">testobj</span><span class="op">@</span><span class="va">feat_metadata</span><span class="op">$</span><span class="va">rna</span></code></pre></div>
<p><strong>addFeatsPerc</strong> can be used to detect the percentage of features in each cell within a given gene family (ie. mitochondrial genes, ribosomal genes)</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Calculate the percentage of BMP genes per cell</span>
<span class="va">featdata</span> <span class="op">=</span> <span class="fu"><a href="../../../reference/fDataDT.html">fDataDT</a></span><span class="op">(</span><span class="va">testobj</span><span class="op">)</span>
<span class="va">bmp_genes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">'Bmp'</span>, x <span class="op">=</span> <span class="va">featdata</span><span class="op">$</span><span class="va">feat_ID</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">testobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/addFeatsPerc.html">addFeatsPerc</a></span><span class="op">(</span><span class="va">testobj</span>, expression_values <span class="op">=</span> <span class="st">'normalized'</span>, feats <span class="op">=</span> <span class="va">bmp_genes</span>, 
                        vector_name <span class="op">=</span> <span class="st">"perc_bmp"</span><span class="op">)</span></code></pre></div>
</div>
<div id="adjust-expression-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#adjust-expression-matrix" class="anchor"></a>4. Adjust Expression Matrix</h2>
<p>Adjust expression matrix for known batch effects or technological covariates</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># In this case, since there are no known batch effects I will be regressing out the number of features detected per cell</span>
<span class="co"># So that covariate will not effect further analysis</span>
<span class="va">testobj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../../reference/adjustGiottoMatrix.html">adjustGiottoMatrix</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">testobj</span>, expression_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'normalized'</span><span class="op">)</span>,
                                 covariate_columns <span class="op">=</span> <span class="st">'nr_feats'</span><span class="op">)</span></code></pre></div>
</div>
<div id="high-efficiency-data-processing" class="section level2">
<h2 class="hasAnchor">
<a href="#high-efficiency-data-processing" class="anchor"></a>5. High Efficiency Data Processing</h2>
<p><strong>processGiotto</strong> completes the filtering, normalization, statistical, and adjustment steps of processing in one single step. This is ideal for faster processing.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../../../reference/processGiotto.html">processGiotto</a></span><span class="op">(</span><span class="va">testobj</span>,filter_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>expression_threshold <span class="op">=</span> <span class="fl">1</span>,feat_det_in_min_cells <span class="op">=</span> <span class="fl">100</span>, min_det_feats_per_cell <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,
                      norm_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> norm_methods <span class="op">=</span> <span class="st">'standard'</span>, scale_feats <span class="op">=</span> <span class="cn">TRUE</span>, scalefactor <span class="op">=</span> <span class="fl">6000</span><span class="op">)</span>,
                      stat_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>expression_values <span class="op">=</span> <span class="st">'normalized'</span><span class="op">)</span>,
                      adjust_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>expression_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'normalized'</span><span class="op">)</span>, covariate_columns <span class="op">=</span> <span class="st">'nr_feats'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.drieslab.com/">Ruben Dries</a>, Jiaji George Chen, Natalie Del Rossi, Emma Kelley, Junxiang Xu, Guo-Cheng Yuan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
